# -*- coding: utf-8 -*-
"""
Created on Mon Jan 27 04:23:42 2025

@author: aakas
"""

import pytest
import numpy as np

from config import config
from Model import Model
from StructuralElements import Node, Member
from Loads import NeumanBC
from FirstOrderResponse import FirstOrderGlobalResponse, FirstOrderMemberResponse

@pytest.fixture
def setup_model():
    config.set_FEDivision(1000)
    PointsT = [
        Node(Node_Number=1, xcoordinate=0, ycoordinate=0, Support_Condition="Fixed Support"),
        Node(Node_Number=2, xcoordinate=10, ycoordinate=0, Support_Condition="Rigid Joint"),
        Node(Node_Number=3, xcoordinate=20, ycoordinate=0, Support_Condition="Fixed Support")
    ]
    MembersT = [
        Member(Beam_Number=1, Start_Node=PointsT[0], End_Node=PointsT[1], Area=1, Youngs_Modulus=1, Moment_of_Inertia=1),
        Member(Beam_Number=2, Start_Node=PointsT[1], End_Node=PointsT[2], Area=1, Youngs_Modulus=1, Moment_of_Inertia=1),
    ]
    LoadsT = [
        NeumanBC(type="UDL", Magnitude=-5, Distance1=0, Distance2=10, AssignedTo="Member 1", Members = MembersT),
        NeumanBC(type="UDL", Magnitude=-5, Distance1=0, Distance2=10, AssignedTo="Member 2", Members = MembersT)
    ]
    Model1 = Model(Points=PointsT, Members=MembersT, Loads=LoadsT)
    Res = FirstOrderGlobalResponse(Points=PointsT, Members=MembersT, Loads=LoadsT)
    MemberResponseT = FirstOrderMemberResponse(Points=PointsT, Members=MembersT, Loads=LoadsT)
    return Model1, Res, MembersT, MemberResponseT

def test_FixedBeamUDL(setup_model):
    ModelT, GlobalResponseT, MembersT, MemberResponseT = setup_model

    # Member Stiffness Matrix of Member 1
    Element1MSM = MembersT[0].First_Order_Global_Stiffness_Matrix_1()
    Element2MSM = MembersT[1].First_Order_Global_Stiffness_Matrix_1()

    Element1MSM_R = [
        [0.1, 0, 0, -0.1, 0, 0],
        [0, 0.012, 0.06, 0, -0.012, 0.06],
        [0, 0.06, 0.4, 0, -0.06, 0.2],
        [-0.1, 0, 0, 0.1, 0, 0],
        [0, -0.012, -0.06, 0, 0.012, -0.06],
        [0, 0.06, 0.2, 0, -0.06, 0.4]
    ]

    Element2MSM_R = [
        [0.1, 0, 0, -0.1, 0, 0],
        [0, 0.012, 0.06, 0, -0.012, 0.06],
        [0, 0.06, 0.4, 0, -0.06, 0.2],
        [-0.1, 0, 0, 0.1, 0, 0],
        [0, -0.012, -0.06, 0, 0.012, -0.06],
        [0, 0.06, 0.2, 0, -0.06, 0.4]
    ]

    # Assert matrix dimensions
    assert len(Element1MSM) == 6, "Stiffness Matrix does not have 6 rows."
    assert all(len(row) == 6 for row in Element1MSM), "Stiffness Matrix does not have 6 columns."

    # Assert member stiffness matrix
    assert np.allclose(Element1MSM, Element1MSM_R, atol=1e-3), "Stiffness matrix of Member 1 is wrong."
    assert np.allclose(Element2MSM, Element2MSM_R, atol=1e-3), "Stiffness matrix of Member 2 is wrong."

    GSMS = ModelT.GlobalStiffnessMatrixCondensed()
    GSMS_R = [
        [0.2, 0, 0],
        [0, 0.024, 0],
        [0, 0, 0.8]
    ]

    # Assert Structures Global Stiffness matrix - condensed a11
    assert np.allclose(GSMS, GSMS_R, atol=1e-3), "Structure Global Stiffness matrix A11 is wrong."

    GSMSa21 = ModelT.GlobalStiffnessMatrixCondensedA21()
    GSMSa21_R = [
        [-0.1, 0, 0],
        [0, -0.012, 0.06],
        [0, -0.06, 0.2],
        [-0.1, 0, 0],
        [0, -0.012, -0.06],
        [0, 0.06, 0.2]
    ]

    # Assert Structures Global Stiffness matrix - condensed a21
    assert np.allclose(GSMSa21, GSMSa21_R, atol=1e-3), "Structure Global Stiffness matrix A21 is wrong"

    FV = ModelT.ForceVector()
    FV_R = [0, -50, 0]
    assert np.allclose(FV, FV_R, atol=1e-3), "Force Vector is wrong"

    DV = GlobalResponseT.DisplacementVector()
    DV_R = [0, -2083.333333, -1.33227E-13]
    assert np.allclose(DV, DV_R, atol=1e-3), "Displacement Vector is wrong"

#CheckMember response

def test_LocalMemberForce(setup_model):
    ModelT, GlobalResponseT, MembersT, MemberResponseT = setup_model

    memr1 = MemberResponseT.MemberForceLocal(1)
    memr2 = MemberResponseT.MemberForceLocal(2)

    memr1_R = [0, 50, 166.67, 0, 0, 83.33]
    memr2_R = [0, 0, -83.33, 0, 50, -166.67]

    assert np.allclose(memr1, memr1_R, atol=1e-3), "Member 1 Local Forces are wrong."
    assert np.allclose(memr2, memr2_R, atol=1e-3), "Member 2 Local Forces are wrong."


def test_GlobalMemberForce(setup_model):
    ModelT, GlobalResponseT, MembersT, MemberResponseT = setup_model

    memr1 = MemberResponseT.MemberForceGlobal(1)
    memr2 = MemberResponseT.MemberForceGlobal(2)

    memr1_R = [0, 50, 166.67, 0, 0, 83.33]
    memr2_R = [0, 0, -83.33, 0, 50, -166.67]

    assert np.allclose(memr1, memr1_R, atol=1e-3), "Member 1 Global Forces are wrong."
    assert np.allclose(memr2, memr2_R, atol=1e-3), "Member 2 Global Forces are wrong."

def test_MemberBMD(setup_model):
    ModelT, GlobalResponseT, MembersT, MemberResponseT = setup_model

    memr1 = MemberResponseT.MemberBMD(1)
    memr2 = MemberResponseT.MemberBMD(2)

    memr1_R = [166.6666667, 166.1664167, 165.6666677, 165.1674197, 164.6686727, 164.1704267, 163.6726817, 163.1754377, 162.6786947, 162.1824527, 161.6867117, 161.1914718, 160.6967328, 160.2024948, 159.7087578, 159.2155218, 158.7227869, 158.2305529, 157.7388199, 157.2475879, 156.756857, 156.266627, 155.776898, 155.2876701, 154.7989431, 154.3107171, 153.8229922, 153.3357682, 152.8490452, 152.3628233, 151.8771023, 151.3918824, 150.9071634, 150.4229455, 149.9392285, 149.4560126, 148.9732976, 148.4910837, 148.0093707, 147.5281588, 147.0474478, 146.5672379, 146.087529, 145.608321, 145.1296141, 144.6514082, 144.1737032, 143.6964993, 143.2197964, 142.7435944, 142.2678935, 141.7926936, 141.3179947, 140.8437967, 140.3700998, 139.8969039, 139.424209, 138.9520151, 138.4803222, 138.0091303, 137.5384393, 137.0682494, 136.5985605, 136.1293726, 135.6606857, 135.1924998, 134.7248149, 134.257631, 133.7909481, 133.3247662, 132.8590853, 132.3939054, 131.9292265, 131.4650486, 131.0013717, 130.5381959, 130.075521, 129.6133471, 129.1516742, 128.6905023, 128.2298314, 127.7696616, 127.3099927, 126.8508248, 126.3921579, 125.9339921, 125.4763272, 125.0191633, 124.5625004, 124.1063386, 123.6506777, 123.1955178, 122.740859, 122.2867011, 121.8330443, 121.3798884, 120.9272335, 120.4750797, 120.0234268, 119.572275, 119.1216241, 118.6714743, 118.2218254, 117.7726776, 117.3240307, 116.8758849, 116.4282401, 115.9810962, 115.5344534, 115.0883115, 114.6426707, 114.1975309, 113.752892, 113.3087542, 112.8651174, 112.4219815, 111.9793467, 111.5372129, 111.0955801, 110.6544482, 110.2138174, 109.7736876, 109.3340588, 108.894931, 108.4563042, 108.0181783, 107.5805535, 107.1434297, 106.7068069, 106.2706851, 105.8350643, 105.3999445, 104.9653257, 104.5312079, 104.0975911, 103.6644753, 103.2318605, 102.7997467, 102.3681339, 101.9370221, 101.5064113, 101.0763015, 100.6466927, 100.217585, 99.78897817, 99.36087238, 98.9332676, 98.50616382, 98.07956104, 97.65345927, 97.22785849, 96.80275871, 96.37815994, 95.95406217, 95.5304654, 95.10736963, 94.68477486, 94.2626811, 93.84108834, 93.41999657, 92.99940581, 92.57931605, 92.15972729, 91.74063954, 91.32205278, 90.90396703, 90.48638228, 90.06929853, 89.65271578, 89.23663403, 88.82105329, 88.40597354, 87.9913948, 87.57731706, 87.16374032, 86.75066458, 86.33808984, 85.92601611, 85.51444337, 85.10337164, 84.69280091, 84.28273118, 83.87316245, 83.46409473, 83.055528, 82.64746228, 82.23989756, 81.83283383, 81.42627112, 81.0202094, 80.61464868, 80.20958897, 79.80503026, 79.40097254, 78.99741583, 78.59436013, 78.19180542, 77.78975171, 77.38819901, 76.98714731, 76.58659661, 76.18654691, 75.78699821, 75.38795051, 74.98940382, 74.59135812, 74.19381343, 73.79676974, 73.40022705, 73.00418537, 72.60864468, 72.213605, 71.81906631, 71.42502863, 71.03149195, 70.63845627, 70.2459216, 69.85388792, 69.46235525, 69.07132358, 68.68079291, 68.29076324, 67.90123457, 67.5122069, 67.12368024, 66.73565457, 66.34812991, 65.96110625, 65.57458359, 65.18856194, 64.80304128, 64.41802163, 64.03350297, 63.64948532, 63.26596867, 62.88295302, 62.50043838, 62.11842473, 61.73691209, 61.35590044, 60.9753898, 60.59538016, 60.21587153, 59.83686389, 59.45835726, 59.08035162, 58.70284699, 58.32584336, 57.94934073, 57.5733391, 57.19783848, 56.82283885, 56.44834023, 56.07434261, 55.70084599, 55.32785037, 54.95535576, 54.58336214, 54.21186953, 53.84087791, 53.4703873, 53.10039769, 52.73090909, 52.36192148, 51.99343488, 51.62544927, 51.25796467, 50.89098107, 50.52449847, 50.15851688, 49.79303628, 49.42805669, 49.06357809, 48.6996005, 48.33612391, 47.97314832, 47.61067374, 47.24870015, 46.88722757, 46.52625599, 46.16578541, 45.80581583, 45.44634725, 45.08737967, 44.7289131, 44.37094752, 44.01348295, 43.65651938, 43.30005681, 42.94409525, 42.58863468, 42.23367512, 41.87921655, 41.52525899, 41.17180243, 40.81884687, 40.46639232, 40.11443876, 39.76298621, 39.41203466, 39.06158411, 38.71163456, 38.36218601, 38.01323846, 37.66479192, 37.31684638, 36.96940183, 36.62245829, 36.27601576, 35.93007422, 35.58463368, 35.23969415, 34.89525562, 34.55131808, 34.20788156, 33.86494603, 33.5225115, 33.18057798, 32.83914545, 32.49821393, 32.15778341, 31.81785389, 31.47842537, 31.13949786, 30.80107134, 30.46314583, 30.12572132, 29.78879781, 29.4523753, 29.11645379, 28.78103329, 28.44611378, 28.11169528, 27.77777778, 27.44436128, 27.11144578, 26.77903128, 26.44711779, 26.11570529, 25.7847938, 25.45438331, 25.12447382, 24.79506534, 24.46615785, 24.13775136, 23.80984588, 23.4824414, 23.15553792, 22.82913544, 22.50323396, 22.17783349, 21.85293402, 21.52853554, 21.20463807, 20.8812416, 20.55834613, 20.23595167, 19.9140582, 19.59266574, 19.27177428, 18.95138382, 18.63149436, 18.3121059, 17.99321844, 17.67483199, 17.35694654, 17.03956208, 16.72267863, 16.40629619, 16.09041474, 15.77503429, 15.46015485, 15.14577641, 14.83189897, 14.51852253, 14.20564709, 13.89327265, 13.58139922, 13.27002678, 12.95915535, 12.64878492, 12.33891549, 12.02954706, 11.72067964, 11.41231321, 11.10444779, 10.79708337, 10.49021995, 10.18385753, 9.877996114, 9.572635699, 9.267776285, 8.963417872, 8.659560461, 8.356204052, 8.053348644, 7.750994237, 7.449140833, 7.147788429, 6.846937027, 6.546586627, 6.246737228, 5.94738883, 5.648541434, 5.35019504, 5.052349647, 4.755005256, 4.458161866, 4.161819477, 3.86597809, 3.570637705, 3.275798321, 2.981459938, 2.687622557, 2.394286178, 2.1014508, 1.809116424, 1.517283049, 1.225950675, 0.935119303, 0.644788933, 0.354959564, 0.065631197, -0.223196169, -0.511522534, -0.799347896, -1.086672258, -1.373495618, -1.659817976, -1.945639333, -2.230959688, -2.515779042, -2.800097395, -3.083914746, -3.367231095, -3.650046443, -3.932360789, -4.214174134, -4.495486477, -4.776297819, -5.05660816, -5.336417499, -5.615725836, -5.894533172, -6.172839506, -6.450644839, -6.72794917, -7.0047525, -7.281054829, -7.556856155, -7.832156481, -8.106955805, -8.381254127, -8.655051448, -8.928347767, -9.201143085, -9.473437401, -9.745230716, -10.01652303, -10.28731434, -10.55760465, -10.82739396, -11.09668227, -11.36546957, -11.63375588, -11.90154118, -12.16882548, -12.43560878, -12.70189108, -12.96767238, -13.23295267, -13.49773197, -13.76201026, -14.02578755, -14.28906384, -14.55183913, -14.81411341, -15.0758867, -15.33715898, -15.59793026, -15.85820054, -16.11796982, -16.3772381, -16.63600537, -16.89427165, -17.15203692, -17.40930119, -17.66606446, -17.92232673, -18.178088, -18.43334826, -18.68810753, -18.94236579, -19.19612305, -19.44937931, -19.70213457, -19.95438882, -20.20614208, -20.45739433, -20.70814558, -20.95839583, -21.20814508, -21.45739333, -21.70614058, -21.95438682, -22.20213206, -22.4493763, -22.69611954, -22.94236178, -23.18810302, -23.43334325, -23.67808249, -23.92232072, -24.16605795, -24.40929418, -24.65202941, -24.89426363, -25.13599686, -25.37722908, -25.6179603, -25.85819052, -26.09791974, -26.33714796, -26.57587517, -26.81410139, -27.0518266, -27.28905081, -27.52577402, -27.76199623, -27.99771744, -28.23293764, -28.46765685, -28.70187505, -28.93559225, -29.16880845, -29.40152365, -29.63373784, -29.86545104, -30.09666323, -30.32737442, -30.55758461, -30.7872938, -31.01650199, -31.24520917, -31.47341536, -31.70112054, -31.92832472, -32.1550279, -32.38123008, -32.60693126, -32.83213143, -33.0568306, -33.28102878, -33.50472595, -33.72792212, -33.95061728, -34.17281145, -34.39450461, -34.61569678, -34.83638794, -35.0565781, -35.27626726, -35.49545542, -35.71414257, -35.93232873, -36.15001388, -36.36719803, -36.58388118, -36.80006333, -37.01574447, -37.23092462, -37.44560376, -37.6597819, -37.87345904, -38.08663518, -38.29931032, -38.51148446, -38.72315759, -38.93432973, -39.14500086, -39.35517099, -39.56484012, -39.77400824, -39.98267537, -40.19084149, -40.39850661, -40.60567074, -40.81233386, -41.01849597, -41.22415709, -41.42931721, -41.63397632, -41.83813443, -42.04179154, -42.24494765, -42.44760276, -42.64975686, -42.85140997, -43.05256207, -43.25321317, -43.45336327, -43.65301237, -43.85216047, -44.05080756, -44.24895366, -44.44659875, -44.64374284, -44.84038593, -45.03652802, -45.23216911, -45.42730919, -45.62194827, -45.81608636, -46.00972344, -46.20285952, -46.39549459, -46.58762867, -46.77926174, -46.97039382, -47.16102489, -47.35115496, -47.54078403, -47.72991209, -47.91853916, -48.10666522, -48.29429029, -48.48141435, -48.66803741, -48.85415946, -49.03978052, -49.22490058, -49.40951963, -49.59363768, -49.77725473, -49.96037078, -50.14298583, -50.32509987, -50.50671292, -50.68782496, -50.868436, -51.04854604, -51.22815508, -51.40726312, -51.58587015, -51.76397619, -51.94158122, -52.11868525, -52.29528828, -52.47139031, -52.64699134, -52.82209136, -52.99669038, -53.17078841, -53.34438543, -53.51748145, -53.69007646, -53.86217048, -54.03376349, -54.20485551, -54.37544652, -54.54553653, -54.71512554, -54.88421354, -55.05280055, -55.22088655, -55.38847155, -55.55555556, -55.72213855, -55.88822055, -56.05380155, -56.21888154, -56.38346054, -56.54753853, -56.71111552, -56.87419151, -57.0367665, -57.19884048, -57.36041347, -57.52148545, -57.68205643, -57.84212641, -58.00169539, -58.16076337, -58.31933034, -58.47739632, -58.63496129, -58.79202526, -58.94858823, -59.1046502, -59.26021116, -59.41527113, -59.56983009, -59.72388805, -59.87744501, -60.03050097, -60.18305593, -60.33510988, -60.48666284, -60.63771479, -60.78826574, -60.93831569, -61.08786464, -61.23691259, -61.38545953, -61.53350548, -61.68105042, -61.82809436, -61.9746373, -62.12067924, -62.26622017, -62.41126011, -62.55579904, -62.69983697, -62.8433739, -62.98640983, -63.12894476, -63.27097869, -63.41251161, -63.55354353, -63.69407445, -63.83410437, -63.97363329, -64.11266121, -64.25118813, -64.38921404, -64.52673895, -64.66376286, -64.80028577, -64.93630768, -65.07182859, -65.20684849, -65.34136739, -65.4753853, -65.6089022, -65.74191809, -65.87443299, -66.00644689, -66.13795978, -66.26897167, -66.39948257, -66.52949246, -66.65900134, -66.78800923, -66.91651612, -67.044522, -67.17202688, -67.29903076, -67.42553364, -67.55153552, -67.6770364, -67.80203627, -67.92653514, -68.05053302, -68.17402989, -68.29702575, -68.41952062, -68.54151449, -68.66300735, -68.78399921, -68.90449008, -69.02447994, -69.14396879, -69.26295665, -69.38144351, -69.49942936, -69.61691421, -69.73389806, -69.85038091, -69.96636276, -70.08184361, -70.19682345, -70.31130229, -70.42528013, -70.53875698, -70.65173281, -70.76420765, -70.87618149, -70.98765432, -71.09862615, -71.20909698, -71.31906681, -71.42853564, -71.53750347, -71.64597029, -71.75393612, -71.86140094, -71.96836476, -72.07482758, -72.1807894, -72.28625021, -72.39121003, -72.49566884, -72.59962665, -72.70308346, -72.80603927, -72.90849408, -73.01044789, -73.11190069, -73.21285249, -73.31330329, -73.41325309, -73.51270189, -73.61164969, -73.71009648, -73.80804228, -73.90548707, -74.00243086, -74.09887365, -74.19481544, -74.29025622, -74.38519601, -74.47963479, -74.57357257, -74.66700935, -74.75994513, -74.85237991, -74.94431368, -75.03574646, -75.12667823, -75.217109, -75.30703877, -75.39646754, -75.48539531, -75.57382207, -75.66174783, -75.7491726, -75.83609636, -75.92251912, -76.00844087, -76.09386163, -76.17878138, -76.26320014, -76.34711789, -76.43053464, -76.51345039, -76.59586513, -76.67777888, -76.75919162, -76.84010337, -76.92051411, -77.00042385, -77.07983259, -77.15874032, -77.23714706, -77.31505279, -77.39245752, -77.46936125, -77.54576398, -77.62166571, -77.69706644, -77.77196616, -77.84636488, -77.9202626, -77.99365932, -78.06655504, -78.13894976, -78.21084348, -78.28223619, -78.3531279, -78.42351861, -78.49340832, -78.56279703, -78.63168474, -78.70007144, -78.76795715, -78.83534185, -78.90222555, -78.96860825, -79.03448995, -79.09987064, -79.16475034, -79.22912903, -79.29300672, -79.35638341, -79.4192591, -79.48163379, -79.54350747, -79.60488016, -79.66575184, -79.72612252, -79.7859922, -79.84536088, -79.90422855, -79.96259523, -80.0204609, -80.07782557, -80.13468924, -80.19105191, -80.24691358, -80.30227425, -80.35713391, -80.41149257, -80.46535024, -80.5187069, -80.57156255, -80.62391721, -80.67577087, -80.72712352, -80.77797517, -80.82832582, -80.87817547, -80.92752412, -80.97637177, -81.02471841, -81.07256406, -81.1199087, -81.16675234, -81.21309498, -81.25893661, -81.30427725, -81.34911688, -81.39345552, -81.43729315, -81.48062978, -81.52346541, -81.56580003, -81.60763366, -81.64896628, -81.68979791, -81.73012853, -81.76995815, -81.80928676, -81.84811438, -81.886441, -81.92426661, -81.96159122, -81.99841483, -82.03473744, -82.07055905, -82.10587965, -82.14069926, -82.17501786, -82.20883546, -82.24215206, -82.27496766, -82.30728226, -82.33909585, -82.37040845, -82.40122004, -82.43153063, -82.46134022, -82.49064881, -82.51945639, -82.54776298, -82.57556856, -82.60287314, -82.62967672, -82.6559793, -82.68178088, -82.70708146, -82.73188103, -82.7561796, -82.77997717, -82.80327374, -82.82606931, -82.84836388, -82.87015744, -82.89145001, -82.91224157, -82.93253213, -82.95232169, -82.97161025, -82.99039781, -83.00868436, -83.02646991, -83.04375447, -83.06053802, -83.07682056, -83.09260211, -83.10788266, -83.1226622, -83.13694074, -83.15071829, -83.16399483, -83.17677036, -83.1890449, -83.20081844, -83.21209097, -83.2228625, -83.23313303, -83.24290256, -83.25217109, -83.26093862, -83.26920514, -83.27697066, -83.28423519, -83.29099871, -83.29726123, -83.30302274, -83.30828326, -83.31304277, -83.31730129, -83.3210588, -83.32431531, -83.32707081, -83.32932532, -83.33107883, -83.33233133, -83.33308283, -83.33333333]

    memr2_R = [-83.33333333, -83.33308283, -83.33233133, -83.33107883, -83.32932532, -83.32707081, -83.32431531, -83.3210588, -83.31730129, -83.31304277, -83.30828326, -83.30302274, -83.29726123, -83.29099871, -83.28423519, -83.27697066, -83.26920514, -83.26093862, -83.25217109, -83.24290256, -83.23313303, -83.2228625, -83.21209097, -83.20081844, -83.1890449, -83.17677036, -83.16399483, -83.15071829, -83.13694074, -83.1226622, -83.10788266, -83.09260211, -83.07682056, -83.06053802, -83.04375447, -83.02646991, -83.00868436, -82.99039781, -82.97161025, -82.95232169, -82.93253213, -82.91224157, -82.89145001, -82.87015744, -82.84836388, -82.82606931, -82.80327374, -82.77997717, -82.7561796, -82.73188103, -82.70708146, -82.68178088, -82.6559793, -82.62967672, -82.60287314, -82.57556856, -82.54776298, -82.51945639, -82.49064881, -82.46134022, -82.43153063, -82.40122004, -82.37040845, -82.33909585, -82.30728226, -82.27496766, -82.24215206, -82.20883546, -82.17501786, -82.14069926, -82.10587965, -82.07055905, -82.03473744, -81.99841483, -81.96159122, -81.92426661, -81.886441, -81.84811438, -81.80928676, -81.76995815, -81.73012853, -81.68979791, -81.64896628, -81.60763366, -81.56580003, -81.52346541, -81.48062978, -81.43729315, -81.39345552, -81.34911688, -81.30427725, -81.25893661, -81.21309498, -81.16675234, -81.1199087, -81.07256406, -81.02471841, -80.97637177, -80.92752412, -80.87817547, -80.82832582, -80.77797517, -80.72712352, -80.67577087, -80.62391721, -80.57156255, -80.5187069, -80.46535024, -80.41149257, -80.35713391, -80.30227425, -80.24691358, -80.19105191, -80.13468924, -80.07782557, -80.0204609, -79.96259523, -79.90422855, -79.84536088, -79.7859922, -79.72612252, -79.66575184, -79.60488016, -79.54350747, -79.48163379, -79.4192591, -79.35638341, -79.29300672, -79.22912903, -79.16475034, -79.09987064, -79.03448995, -78.96860825, -78.90222555, -78.83534185, -78.76795715, -78.70007144, -78.63168474, -78.56279703, -78.49340832, -78.42351861, -78.3531279, -78.28223619, -78.21084348, -78.13894976, -78.06655504, -77.99365932, -77.9202626, -77.84636488, -77.77196616, -77.69706644, -77.62166571, -77.54576398, -77.46936125, -77.39245752, -77.31505279, -77.23714706, -77.15874032, -77.07983259, -77.00042385, -76.92051411, -76.84010337, -76.75919162, -76.67777888, -76.59586513, -76.51345039, -76.43053464, -76.34711789, -76.26320014, -76.17878138, -76.09386163, -76.00844087, -75.92251912, -75.83609636, -75.7491726, -75.66174783, -75.57382207, -75.48539531, -75.39646754, -75.30703877, -75.217109, -75.12667823, -75.03574646, -74.94431368, -74.85237991, -74.75994513, -74.66700935, -74.57357257, -74.47963479, -74.38519601, -74.29025622, -74.19481544, -74.09887365, -74.00243086, -73.90548707, -73.80804228, -73.71009648, -73.61164969, -73.51270189, -73.41325309, -73.31330329, -73.21285249, -73.11190069, -73.01044789, -72.90849408, -72.80603927, -72.70308346, -72.59962665, -72.49566884, -72.39121003, -72.28625021, -72.1807894, -72.07482758, -71.96836476, -71.86140094, -71.75393612, -71.64597029, -71.53750347, -71.42853564, -71.31906681, -71.20909698, -71.09862615, -70.98765432, -70.87618149, -70.76420765, -70.65173281, -70.53875698, -70.42528013, -70.31130229, -70.19682345, -70.08184361, -69.96636276, -69.85038091, -69.73389806, -69.61691421, -69.49942936, -69.38144351, -69.26295665, -69.14396879, -69.02447994, -68.90449008, -68.78399921, -68.66300735, -68.54151449, -68.41952062, -68.29702575, -68.17402989, -68.05053302, -67.92653514, -67.80203627, -67.6770364, -67.55153552, -67.42553364, -67.29903076, -67.17202688, -67.044522, -66.91651612, -66.78800923, -66.65900134, -66.52949246, -66.39948257, -66.26897167, -66.13795978, -66.00644689, -65.87443299, -65.74191809, -65.6089022, -65.4753853, -65.34136739, -65.20684849, -65.07182859, -64.93630768, -64.80028577, -64.66376286, -64.52673895, -64.38921404, -64.25118813, -64.11266121, -63.97363329, -63.83410437, -63.69407445, -63.55354353, -63.41251161, -63.27097869, -63.12894476, -62.98640983, -62.8433739, -62.69983697, -62.55579904, -62.41126011, -62.26622017, -62.12067924, -61.9746373, -61.82809436, -61.68105042, -61.53350548, -61.38545953, -61.23691259, -61.08786464, -60.93831569, -60.78826574, -60.63771479, -60.48666284, -60.33510988, -60.18305593, -60.03050097, -59.87744501, -59.72388805, -59.56983009, -59.41527113, -59.26021116, -59.1046502, -58.94858823, -58.79202526, -58.63496129, -58.47739632, -58.31933034, -58.16076337, -58.00169539, -57.84212641, -57.68205643, -57.52148545, -57.36041347, -57.19884048, -57.0367665, -56.87419151, -56.71111552, -56.54753853, -56.38346054, -56.21888154, -56.05380155, -55.88822055, -55.72213855, -55.55555556, -55.38847155, -55.22088655, -55.05280055, -54.88421354, -54.71512554, -54.54553653, -54.37544652, -54.20485551, -54.03376349, -53.86217048, -53.69007646, -53.51748145, -53.34438543, -53.17078841, -52.99669038, -52.82209136, -52.64699134, -52.47139031, -52.29528828, -52.11868525, -51.94158122, -51.76397619, -51.58587015, -51.40726312, -51.22815508, -51.04854604, -50.868436, -50.68782496, -50.50671292, -50.32509987, -50.14298583, -49.96037078, -49.77725473, -49.59363768, -49.40951963, -49.22490058, -49.03978052, -48.85415946, -48.66803741, -48.48141435, -48.29429029, -48.10666522, -47.91853916, -47.72991209, -47.54078403, -47.35115496, -47.16102489, -46.97039382, -46.77926174, -46.58762867, -46.39549459, -46.20285952, -46.00972344, -45.81608636, -45.62194827, -45.42730919, -45.23216911, -45.03652802, -44.84038593, -44.64374284, -44.44659875, -44.24895366, -44.05080756, -43.85216047, -43.65301237, -43.45336327, -43.25321317, -43.05256207, -42.85140997, -42.64975686, -42.44760276, -42.24494765, -42.04179154, -41.83813443, -41.63397632, -41.42931721, -41.22415709, -41.01849597, -40.81233386, -40.60567074, -40.39850661, -40.19084149, -39.98267537, -39.77400824, -39.56484012, -39.35517099, -39.14500086, -38.93432973, -38.72315759, -38.51148446, -38.29931032, -38.08663518, -37.87345904, -37.6597819, -37.44560376, -37.23092462, -37.01574447, -36.80006333, -36.58388118, -36.36719803, -36.15001388, -35.93232873, -35.71414257, -35.49545542, -35.27626726, -35.0565781, -34.83638794, -34.61569678, -34.39450461, -34.17281145, -33.95061728, -33.72792212, -33.50472595, -33.28102878, -33.0568306, -32.83213143, -32.60693126, -32.38123008, -32.1550279, -31.92832472, -31.70112054, -31.47341536, -31.24520917, -31.01650199, -30.7872938, -30.55758461, -30.32737442, -30.09666323, -29.86545104, -29.63373784, -29.40152365, -29.16880845, -28.93559225, -28.70187505, -28.46765685, -28.23293764, -27.99771744, -27.76199623, -27.52577402, -27.28905081, -27.0518266, -26.81410139, -26.57587517, -26.33714796, -26.09791974, -25.85819052, -25.6179603, -25.37722908, -25.13599686, -24.89426363, -24.65202941, -24.40929418, -24.16605795, -23.92232072, -23.67808249, -23.43334325, -23.18810302, -22.94236178, -22.69611954, -22.4493763, -22.20213206, -21.95438682, -21.70614058, -21.45739333, -21.20814508, -20.95839583, -20.70814558, -20.45739433, -20.20614208, -19.95438882, -19.70213457, -19.44937931, -19.19612305, -18.94236579, -18.68810753, -18.43334826, -18.178088, -17.92232673, -17.66606446, -17.40930119, -17.15203692, -16.89427165, -16.63600537, -16.3772381, -16.11796982, -15.85820054, -15.59793026, -15.33715898, -15.0758867, -14.81411341, -14.55183913, -14.28906384, -14.02578755, -13.76201026, -13.49773197, -13.23295267, -12.96767238, -12.70189108, -12.43560878, -12.16882548, -11.90154118, -11.63375588, -11.36546957, -11.09668227, -10.82739396, -10.55760465, -10.28731434, -10.01652303, -9.745230716, -9.473437401, -9.201143085, -8.928347767, -8.655051448, -8.381254127, -8.106955805, -7.832156481, -7.556856155, -7.281054829, -7.0047525, -6.72794917, -6.450644839, -6.172839506, -5.894533172, -5.615725836, -5.336417499, -5.05660816, -4.776297819, -4.495486477, -4.214174134, -3.932360789, -3.650046443, -3.367231095, -3.083914746, -2.800097395, -2.515779042, -2.230959688, -1.945639333, -1.659817976, -1.373495618, -1.086672258, -0.799347896, -0.511522534, -0.223196169, 0.065631197, 0.354959564, 0.644788933, 0.935119303, 1.225950675, 1.517283049, 1.809116424, 2.1014508, 2.394286178, 2.687622557, 2.981459938, 3.275798321, 3.570637705, 3.86597809, 4.161819477, 4.458161866, 4.755005256, 5.052349647, 5.35019504, 5.648541434, 5.94738883, 6.246737228, 6.546586627, 6.846937027, 7.147788429, 7.449140833, 7.750994237, 8.053348644, 8.356204052, 8.659560461, 8.963417872, 9.267776285, 9.572635699, 9.877996114, 10.18385753, 10.49021995, 10.79708337, 11.10444779, 11.41231321, 11.72067964, 12.02954706, 12.33891549, 12.64878492, 12.95915535, 13.27002678, 13.58139922, 13.89327265, 14.20564709, 14.51852253, 14.83189897, 15.14577641, 15.46015485, 15.77503429, 16.09041474, 16.40629619, 16.72267863, 17.03956208, 17.35694654, 17.67483199, 17.99321844, 18.3121059, 18.63149436, 18.95138382, 19.27177428, 19.59266574, 19.9140582, 20.23595167, 20.55834613, 20.8812416, 21.20463807, 21.52853554, 21.85293402, 22.17783349, 22.50323396, 22.82913544, 23.15553792, 23.4824414, 23.80984588, 24.13775136, 24.46615785, 24.79506534, 25.12447382, 25.45438331, 25.7847938, 26.11570529, 26.44711779, 26.77903128, 27.11144578, 27.44436128, 27.77777778, 28.11169528, 28.44611378, 28.78103329, 29.11645379, 29.4523753, 29.78879781, 30.12572132, 30.46314583, 30.80107134, 31.13949786, 31.47842537, 31.81785389, 32.15778341, 32.49821393, 32.83914545, 33.18057798, 33.5225115, 33.86494603, 34.20788156, 34.55131808, 34.89525562, 35.23969415, 35.58463368, 35.93007422, 36.27601576, 36.62245829, 36.96940183, 37.31684638, 37.66479192, 38.01323846, 38.36218601, 38.71163456, 39.06158411, 39.41203466, 39.76298621, 40.11443876, 40.46639232, 40.81884687, 41.17180243, 41.52525899, 41.87921655, 42.23367512, 42.58863468, 42.94409525, 43.30005681, 43.65651938, 44.01348295, 44.37094752, 44.7289131, 45.08737967, 45.44634725, 45.80581583, 46.16578541, 46.52625599, 46.88722757, 47.24870015, 47.61067374, 47.97314832, 48.33612391, 48.6996005, 49.06357809, 49.42805669, 49.79303628, 50.15851688, 50.52449847, 50.89098107, 51.25796467, 51.62544927, 51.99343488, 52.36192148, 52.73090909, 53.10039769, 53.4703873, 53.84087791, 54.21186953, 54.58336214, 54.95535576, 55.32785037, 55.70084599, 56.07434261, 56.44834023, 56.82283885, 57.19783848, 57.5733391, 57.94934073, 58.32584336, 58.70284699, 59.08035162, 59.45835726, 59.83686389, 60.21587153, 60.59538016, 60.9753898, 61.35590044, 61.73691209, 62.11842473, 62.50043838, 62.88295302, 63.26596867, 63.64948532, 64.03350297, 64.41802163, 64.80304128, 65.18856194, 65.57458359, 65.96110625, 66.34812991, 66.73565457, 67.12368024, 67.5122069, 67.90123457, 68.29076324, 68.68079291, 69.07132358, 69.46235525, 69.85388792, 70.2459216, 70.63845627, 71.03149195, 71.42502863, 71.81906631, 72.213605, 72.60864468, 73.00418537, 73.40022705, 73.79676974, 74.19381343, 74.59135812, 74.98940382, 75.38795051, 75.78699821, 76.18654691, 76.58659661, 76.98714731, 77.38819901, 77.78975171, 78.19180542, 78.59436013, 78.99741583, 79.40097254, 79.80503026, 80.20958897, 80.61464868, 81.0202094, 81.42627112, 81.83283383, 82.23989756, 82.64746228, 83.055528, 83.46409473, 83.87316245, 84.28273118, 84.69280091, 85.10337164, 85.51444337, 85.92601611, 86.33808984, 86.75066458, 87.16374032, 87.57731706, 87.9913948, 88.40597354, 88.82105329, 89.23663403, 89.65271578, 90.06929853, 90.48638228, 90.90396703, 91.32205278, 91.74063954, 92.15972729, 92.57931605, 92.99940581, 93.41999657, 93.84108834, 94.2626811, 94.68477486, 95.10736963, 95.5304654, 95.95406217, 96.37815994, 96.80275871, 97.22785849, 97.65345927, 98.07956104, 98.50616382, 98.9332676, 99.36087238, 99.78897817, 100.217585, 100.6466927, 101.0763015, 101.5064113, 101.9370221, 102.3681339, 102.7997467, 103.2318605, 103.6644753, 104.0975911, 104.5312079, 104.9653257, 105.3999445, 105.8350643, 106.2706851, 106.7068069, 107.1434297, 107.5805535, 108.0181783, 108.4563042, 108.894931, 109.3340588, 109.7736876, 110.2138174, 110.6544482, 111.0955801, 111.5372129, 111.9793467, 112.4219815, 112.8651174, 113.3087542, 113.752892, 114.1975309, 114.6426707, 115.0883115, 115.5344534, 115.9810962, 116.4282401, 116.8758849, 117.3240307, 117.7726776, 118.2218254, 118.6714743, 119.1216241, 119.572275, 120.0234268, 120.4750797, 120.9272335, 121.3798884, 121.8330443, 122.2867011, 122.740859, 123.1955178, 123.6506777, 124.1063386, 124.5625004, 125.0191633, 125.4763272, 125.9339921, 126.3921579, 126.8508248, 127.3099927, 127.7696616, 128.2298314, 128.6905023, 129.1516742, 129.6133471, 130.075521, 130.5381959, 131.0013717, 131.4650486, 131.9292265, 132.3939054, 132.8590853, 133.3247662, 133.7909481, 134.257631, 134.7248149, 135.1924998, 135.6606857, 136.1293726, 136.5985605, 137.0682494, 137.5384393, 138.0091303, 138.4803222, 138.9520151, 139.424209, 139.8969039, 140.3700998, 140.8437967, 141.3179947, 141.7926936, 142.2678935, 142.7435944, 143.2197964, 143.6964993, 144.1737032, 144.6514082, 145.1296141, 145.608321, 146.087529, 146.5672379, 147.0474478, 147.5281588, 148.0093707, 148.4910837, 148.9732976, 149.4560126, 149.9392285, 150.4229455, 150.9071634, 151.3918824, 151.8771023, 152.3628233, 152.8490452, 153.3357682, 153.8229922, 154.3107171, 154.7989431, 155.2876701, 155.776898, 156.266627, 156.756857, 157.2475879, 157.7388199, 158.2305529, 158.7227869, 159.2155218, 159.7087578, 160.2024948, 160.6967328, 161.1914718, 161.6867117, 162.1824527, 162.6786947, 163.1754377, 163.6726817, 164.1704267, 164.6686727, 165.1674197, 165.6666677, 166.1664167, 166.6666667]
    
    assert np.allclose(memr1, memr1_R, atol=1e-0), "Member 1 BMD is wrong."
    assert np.allclose(memr2, memr2_R, atol=1e-0), "Member 2 BMD is wrong."

